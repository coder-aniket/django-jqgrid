{% extends 'example/base.html' %}
{% load static %}

{% block title %}{{ title }} - Django jqGrid Examples{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-md-8">
            <h1 class="h2">
                <i class="fas fa-tags text-primary"></i>
                {{ title }}
            </h1>
            <p class="text-muted">{{ description }}</p>
        </div>
        <div class="col-md-4 text-end">
            <a href="{% url 'example:index' %}" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left"></i>
                Back to Examples
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Category Management</h5>
                </div>
                <div class="card-body">
                    <table id="{{ grid_id }}"></table>
                    <div id="{{ grid_id }}Pager"></div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    $('#{{ grid_id }}').jqGrid({
        url: '{{ api_url }}',
        datatype: 'json',
        mtype: 'GET',
        colNames: ['ID', 'Name', 'Description', 'Active', 'Products', 'Created'],
        colModel: [
            {name: 'id', index: 'id', width: 60, sortable: true, hidden: true, key: true},
            {name: 'name', index: 'name', width: 200, sortable: true},
            {name: 'description', index: 'description', width: 300, sortable: false},
            {
                name: 'active', 
                index: 'active', 
                width: 80, 
                sortable: true, 
                align: 'center',
                formatter: function(cellvalue, options, rowObject) {
                    return cellvalue ? 
                        '<i class="fas fa-check-circle text-success"></i>' : 
                        '<i class="fas fa-times-circle text-danger"></i>';
                }
            },
            {name: 'product_count', index: 'product_count', width: 100, sortable: false, align: 'center'},
            {name: 'created_at', index: 'created_at', width: 120, sortable: true, formatter: 'date'}
        ],
        pager: '#{{ grid_id }}Pager',
        rowNum: 25,
        sortname: 'name',
        sortorder: 'asc',
        viewrecords: true,
        autowidth: true,
        height: 400
    });
    
    $('#{{ grid_id }}').jqGrid('navGrid', '#{{ grid_id }}Pager', {
        edit: false, add: false, del: false, search: true, refresh: true
    });
});
</script>
{% endblock %}